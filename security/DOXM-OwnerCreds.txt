/*
@startuml
autonumber
title Owner Credential (OC) Assignment Sequence
participant "On-boarding Tool\n(UUID B0B0XXXX-...)" as OT
participant "New Device\n(UUID A21CXXXX-...)" as ND

note over OT, ND
If a symmetric credential type was selected, independently derive a shared symmetric key
end note
OT->OT: SharedKey = PRF (MasterSecret, "oic.sec.oxm.mfgcert", "uuid":"B0B0XXXX-...", "uuid":"A21CXXXX-...", "68")
ND->ND: Derive SharedKey Locally
ND->ND: Replace the "privatedata" \nof received credential
ND->OT: RSP 2.04

break

autonumber 1

note over OT, ND
If an asymmetric or certificate credential type was selected, provision the OBT public key
to the device and register the device's public key
end note
ND->OT: RSP 2.04
ND->ND: Generate Key Pair
OT->ND: GET /oic/sec/cred?subjectuuid="A21CXXXX-..."

note over OT, ND
If certificate credential type was selected, issue a device certificate to the new device
end note
OT<->ND: Perform asymmetric credential exchange above
ND->OT: RSP 2.04

note over OT, ND
Assign valid "rowneruuid" to each implemented security resource (not shown).
end note

note over OT, ND
Update the owned status. Device is now ready to move to provisioning and "RFPRO" state.
end note
ND->OT: RSP 2.04

note over OT, ND
Move device to RFPRO state.
end note
ND->OT: RSP 2.04

note over OT, ND
Provision the new device with additional credentials for device management and device-to-device communications (not shown).
end note

note over OT, ND
Enter "RFNOP" state to enable normal operation.
end note
ND->OT: RSP 2.04

@enduml
*/
